<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Termo — Jogo estilo Wordle</title>
  <style>
    :root{
        --bg:#0f1724;
        --card:#0b1220;
        --text:#e6eef8;
        --muted:#9aa9bf;
        --correct:#6aaa64;
        --present:#c9b458;
        --absent:#3a4554;
    }
    *{
        box-sizing:border-box
    }
    body{
        margin:0;
        min-height:100vh;
        background:linear-gradient(180deg,#071029 0%, #071733 60%);
        font-family:Inter, system-ui, sans-serif;
        color:var(--text);
        display:flex;
        align-items:center;
        justify-content:center;
        padding:24px
    }
    .app{
        width:100%;
        max-width:760px
    }
    header{
        display:flex;
        align-items:center;
        justify-content:space-between;
        margin-bottom:18px
    }
    h1{font-size:20px;
        margin:0
    }
    .controls{
        display:flex;
        gap:8px;
        align-items:center
    }
    button,select{
        background:var(--card);
        color:var(--text);
        border:1px solid rgba(255,255,255,0.04);
        padding:8px 10px;
        border-radius:8px;
        cursor:pointer
    }
    button:hover{
        background:#1b2640
    }
    .card{
        background:rgba(11,18,30,0.6);
        padding:18px;
        border-radius:12px;
        box-shadow:0 6px 30px rgba(2,6,23,0.6)
    }
    .board{
        display:grid;
        grid-template-rows:repeat(6,1fr);
        gap:8px;
        width:100%;
        margin:18px auto
    }
    .row{
        display:grid;
        grid-template-columns:repeat(5,1fr);
        gap:8px
    }
    .tile{
        aspect-ratio:1/1;
        display:flex;
        align-items:center;
        justify-content:center;
        border-radius:8px;
        background:rgba(255,255,255,0.03);
        font-weight:700;
        font-size:22px;
        color:var(--text);
        text-transform:uppercase
    }
    .tile.flip{
        animation:flip 600ms ease forwards
    }
    @keyframes flip{
        0%{transform:rotateX(0)}50%{transform:rotateX(90deg)}100%{transform:rotateX(0)}
    }
    .keyboard{
        margin-top:12px;
        display:grid;
        gap:8px
    }
    .kb-row{
        display:flex;
        gap:6px;
        justify-content:center
    }
    .key{
        padding:10px 12px;
        border-radius:6px;
        background:rgba(255,255,255,0.03);
        border:none;
        color:var(--text);
        font-weight:600;
        cursor:pointer
    }
    .key.wide{
        padding:10px 18px
    }
    .key.disabled{
        opacity:0.5;cursor:default
    }
    .status{
        margin-top:12px;display:flex;align-items:center;gap:12px
    }
    .timer{
        font-weight:700
    }
    .message{
        margin-top:12px;color:var(--muted)
    }
    footer{
        margin-top:12px;font-size:13px;color:var(--muted);text-align:center
    }
    .hidden{
        display:none
    }
    /* botão de voltar */
    #voltarMenu{
      position:absolute;
      top:16px;
      left:16px;
      background:rgba(11,18,30,0.6);
      padding:8px 16px;
      border-radius:8px;
      border:1px solid rgba(255,255,255,0.1);
      color:var(--text);
      cursor:pointer;
      transition:all 0.3s ease;
    }
    #voltarMenu:hover{background:#1b2640;transform:scale(1.05)}
  </style>
</head>
<body>
  <button id="voltarMenu" onclick="voltarMenu()">← Voltar ao menu</button>

  <div class="app">
    <header>
      <h1>Termo — Estilo Wordle</h1>
      <div class="controls">
        <button id="newGame">Novo Jogo</button>
      </div>
    </header>

    <div class="card">
      <div id="board" class="board" aria-live="polite"></div>

      <div class="status">
        <div class="timer hidden" id="timer">Tempo: <span id="timeLeft">60</span>s</div>
        <div class="attempts">Tentativas: <span id="attemptsLeft">6</span></div>
      </div>

      <div class="message" id="message">Use o teclado ou clique nas teclas abaixo. Pressione ENTER para enviar.</div>
      <div class="keyboard" id="keyboard"></div>

      <footer>Palavras de 5 letras. No modo difícil, você tem 60 segundos no total.</footer>
    </div>
  </div>

  <script>
    // --- CONFIG ---
    const WORD_LENGTH = 5;
    const MAX_ATTEMPTS = 6;
    const HARD_TIME = 60; // segundos

    const WORDS = [
      'AMORU','CASAS','SOLAR','LIMAO','FAROL','LINHA','PONTO','CARRO',
      'GATOS','CACHO','ROSAO','BOLAS','FRUTA','TEXTO','NIVEL','LIVRO',
      'PLANO','MUNDO','FESTA','JOGAR','TERMO','VIVER','PODER','FORCA'
    ];
    const VALID = new Set([...WORDS,'FALAR','DIZER','TRAIR','PENSO','LUGAR','FIMAO']);

    // --- ELEMENTOS ---
    let solution = '';
    const boardEl = document.getElementById('board');
    const keyboardEl = document.getElementById('keyboard');
    const msgEl = document.getElementById('message');
    const timerEl = document.getElementById('timer');
    const timeLeftEl = document.getElementById('timeLeft');
    const attemptsLeftEl = document.getElementById('attemptsLeft');
    const newBtn = document.getElementById('newGame');

    // --- ESTADO ---
    let grid = [];
    let currentRow = 0;
    let currentCol = 0;
    let gameOver = false;
    let timeRemaining = HARD_TIME;
    let timerInterval = null;
    let modo = 'facil'; // padrão

    // --- INICIALIZAÇÃO ---
    window.onload = () => {
      const params = new URLSearchParams(window.location.search);
      modo = params.get('modo') || 'facil';
      startGame();
    };

    function voltarMenu(){
      if(confirm('Deseja voltar ao menu principal? O progresso atual será perdido.')){
        window.location.href = 'index.html';
      }
    }

    newBtn.addEventListener('click', startGame);

    function pickSolution(){ return WORDS[Math.floor(Math.random()*WORDS.length)]; }

    function startGame(){
      stopTimer();
      solution = pickSolution().toUpperCase();
      currentRow = 0; currentCol = 0; gameOver = false;
      initBoard(); initKeyboard();
      msgEl.textContent = 'Use o teclado ou clique nas teclas abaixo. Pressione ENTER para enviar.';
      attemptsLeftEl.textContent = MAX_ATTEMPTS;

      if(modo === 'dificil'){
        startTimer();
        showMessage('Modo difícil: 60 segundos no total. Boa sorte!', 2500);
      } else {
        stopTimer();
        showMessage('Modo fácil: sem limite de tempo.', 2000);
      }
    }

    function initBoard(){
      boardEl.innerHTML = '';
      grid = [];
      for(let r=0;r<MAX_ATTEMPTS;r++){
        const row = document.createElement('div');
        row.className = 'row';
        const arr = [];
        for(let c=0;c<WORD_LENGTH;c++){
          const tile = document.createElement('div');
          tile.className = 'tile';
          tile.dataset.row=r; tile.dataset.col=c;
          row.appendChild(tile);
          arr.push('');
        }
        boardEl.appendChild(row);
        grid.push(arr);
      }
    }

    function initKeyboard(){
      keyboardEl.innerHTML = '';
      const rows = ['QWERTYUIOP','ASDFGHJKL','ZXCVBNM'];
      rows.forEach((r,i)=>{
        const kbRow=document.createElement('div');
        kbRow.className='kb-row';
        if(i===2){ kbRow.appendChild(makeKey('ENTER',true)); }
        for(const ch of r){ kbRow.appendChild(makeKey(ch)); }
        if(i===2){ kbRow.appendChild(makeKey('⌫',true)); }
        keyboardEl.appendChild(kbRow);
      });
    }

    function makeKey(label,wide=false){
      const btn=document.createElement('button');
      btn.className='key'+(wide?' wide':'');
      btn.textContent=label;
      btn.onclick=()=>onKey(label);
      return btn;
    }

    function onKey(k){
      if(gameOver) return;
      if(k==='ENTER') return submitGuess();
      if(k==='⌫') return backspace();
      addLetter(k);
    }

    function addLetter(l){
      if(currentCol>=WORD_LENGTH) return;
      grid[currentRow][currentCol]=l.toUpperCase();
      getTile(currentRow,currentCol).textContent=l;
      currentCol++;
    }

    function backspace(){
      if(currentCol<=0) return;
      currentCol--;
      grid[currentRow][currentCol]='';
      getTile(currentRow,currentCol).textContent='';
    }

    function submitGuess(){
      if(currentCol<WORD_LENGTH) return showMessage('A palavra precisa ter 5 letras.');
      const guess=grid[currentRow].join('');
      if(!VALID.has(guess)) return showMessage('Palavra não encontrada.');
      revealRow(currentRow,guess);
    }

    function revealRow(row,guess){
      const sol=solution.split('');
      const guessArr=guess.split('');
      const result=Array(WORD_LENGTH).fill('absent');
      const solCount={};
      for(const ch of sol) solCount[ch]=(solCount[ch]||0)+1;
      for(let i=0;i<WORD_LENGTH;i++){
        if(guessArr[i]===sol[i]){result[i]='correct';solCount[guessArr[i]]--;}
      }
      for(let i=0;i<WORD_LENGTH;i++){
        if(result[i]!=='correct'&&solCount[guessArr[i]]>0){
          result[i]='present';solCount[guessArr[i]]--;
        }
      }
      for(let i=0;i<WORD_LENGTH;i++){
        const t=getTile(row,i);
        setTimeout(()=>{
          t.classList.add('flip');
          t.style.background=result[i]==='correct'?'var(--correct)':result[i]==='present'?'var(--present)':'var(--absent)';
          t.style.color='#021012';
          t.classList.remove('flip');
          updateKeyColor(guessArr[i],result[i]);
        },i*250);
      }
      setTimeout(()=>{
        if(guess===solution) gameWin();
        else{
          currentRow++;
          currentCol=0;
          attemptsLeftEl.textContent=MAX_ATTEMPTS-currentRow;
          if(currentRow>=MAX_ATTEMPTS) gameLose();
        }
      },WORD_LENGTH*250+300);
    }

    function updateKeyColor(letter,result){
      for(const b of keyboardEl.querySelectorAll('.key')){
        if(b.textContent===letter){
          const order={absent:0,present:1,correct:2};
          const prev=b.dataset.state;
          if(!prev||order[result]>order[prev]){
            b.dataset.state=result;
            b.style.background=result==='correct'?'var(--correct)':result==='present'?'var(--present)':'var(--absent)';
            b.style.color='#021012';
          }
        }
      }
    }

    function getTile(r,c){return boardEl.querySelector(`.tile[data-row='${r}'][data-col='${c}']`);}
    function showMessage(t,time=2000){msgEl.textContent=t;if(time>0)setTimeout(()=>{if(!gameOver)msgEl.textContent='Use o teclado ou clique nas teclas abaixo. Pressione ENTER para enviar.';},time);}
    function gameWin(){gameOver=true;showMessage('Parabéns — você acertou!');stopTimer();}
    function gameLose(){gameOver=true;showMessage('Fim de jogo — a palavra era: '+solution);stopTimer();}

    // TIMER
    function startTimer(){
      stopTimer();
      timeRemaining=HARD_TIME;
      timeLeftEl.textContent=timeRemaining;
      timerEl.classList.remove('hidden');
      timerInterval=setInterval(()=>{
        timeRemaining--;
        timeLeftEl.textContent=timeRemaining;
        if(timeRemaining<=0){
          clearInterval(timerInterval);
          timerInterval=null;
          if(!gameOver){gameOver=true;showMessage('Tempo esgotado! A palavra era: '+solution);}
        }
      },1000);
    }
    function stopTimer(){if(timerInterval)clearInterval(timerInterval);timerInterval=null;timerEl.classList.add('hidden');}

    // teclado físico
    window.addEventListener('keydown',e=>{
      if(gameOver) return;
      if(e.key==='Enter') return submitGuess();
      if(e.key==='Backspace') return backspace();
      const k=e.key.toUpperCase();
      if(k.length===1&&k>='A'&&k<='Z') addLetter(k);
    });
  </script>
</body>
</html>
